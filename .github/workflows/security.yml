name: Security Scanning

on: 
    schedule:
      - cron: '0 0 * * 1'  # Weekly on Sundays at midnight
    workflow_dispatch:

jobs:
    security_scan:
        name: Weekly Security Scan
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Run Dependency Check
              uses: dependency-check/Dependency-Check_Action@main
              with:
                project: 'Issue Tracker'
                path: '.'
                format: 'JSON'

            - name: Run Semgrep
              uses: semgrep/semgrep-action@v1
              with: 
                config: >-
                    p/security-audit
                    p/secrets
                    p/oswasp-top-ten
                    p/javascript

            - name: Container Security Scan
              run: |
                docker run --rm -v "${{ github.workspace }}:/src"
                    aquasec/trivy fs --security-checks vuln,secret,config /src